# Code's Bad Smell

![img](d:/resource/notePic/O1CN01C9Anzh1oAJu4wxeOU_!!6000000005184-0-tps-1686-1158.jpg)

### 重复代码

#### 同一个类中不同函数具有重复代码

考虑提取为公用的函数。



#### 两个兄弟类中具有重复代码

考虑将其提取为父类的函数，将相同的代码提取到共同父类中，针对有差异化的部分，使用抽象函数延迟到子类实现，这就是常见的模板函数设计模式。



#### 两个毫不相干的类的具有重复代码

考虑将重复代码提炼到一个新类中，然后在这两个类中调用这个新类的函数。



### 命名问题

类、函数、变量等命名合适时，就不要注释。项目整体命名风格要统一，不要出现一个命名多种含义、命名不知义的情况。

好的命名：

- 保证意义明确的前提下，尽量简短
- 一致性，遵守统一的规范
- 体现副作用



### 类职责不单一

单一职责是面向对象编程的原则之一，如果一个对象/类职责不单一，则其定位和含义就不明确，需要拆分成多个对象。



### 函数过长

函数过长会增加阅读者的成本，好的函数是单一职责、短小精悍的，过长往往是因为其承担了太多功能，或者现抽象纬度不统一



### if-else 过多过深

if-else 过多过深会增加阅读者的成本，想象一下 `>` 型的代码，读者在进入下一层的时候，还需要记住上一层的 if，层数过多时读起来很痛苦。

解决方式：提前 return；使用策略模式优化代码结构



### RPC 函数返回值包含枚举

RPC 函数返回对象中，尽量不要包含枚举，因为如果服务提供方在枚举中新增了枚举值，并且返回枚举就是这个新增枚举值，而服务调用方未更新二方包版本，则会导致反序列化出错，导致函数调用失败



